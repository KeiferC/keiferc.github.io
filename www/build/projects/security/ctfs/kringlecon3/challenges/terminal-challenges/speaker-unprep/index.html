
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Terminal/Speaker Unprep - [Write-up] Kringlecon 3: French Hens</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.75751829.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#speaker-unprep" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="[Write-up] Kringlecon 3: French Hens" class="md-header-nav__button md-logo" aria-label="[Write-up] Kringlecon 3: French Hens">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            [Write-up] Kringlecon 3: French Hens
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Terminal/Speaker Unprep
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="[Write-up] Kringlecon 3: French Hens" class="md-nav__button md-logo" aria-label="[Write-up] Kringlecon 3: French Hens">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    [Write-up] Kringlecon 3: French Hens
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../01-uncover-santas-gift-list/" class="md-nav__link">
      Objective 01
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../02-investigate-s3-bucket/" class="md-nav__link">
      Objective 02
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../03-point-of-sale-password-recovery/" class="md-nav__link">
      Objective 03
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../04-operate-the-santavator/" class="md-nav__link">
      Objective 04
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../05-open-hid-lock/" class="md-nav__link">
      Objective 05
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../06-splunk-challenge/" class="md-nav__link">
      Objective 06
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../07-can-d-bus-problem/" class="md-nav__link">
      Objective 07
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../08-broken-tag-generator/" class="md-nav__link">
      Objective 08
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../09-arp-shenanigans/" class="md-nav__link">
      Objective 09
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../10-defeat-fingerprint-sensor/" class="md-nav__link">
      Objective 10
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../33.6kbps/" class="md-nav__link">
      Terminal/33.6kbps
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../can-bus-investigation/" class="md-nav__link">
      Terminal/CAN Bus Investigations
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../debug-redis/" class="md-nav__link">
      Terminal/Debug Redis
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../elf-code/" class="md-nav__link">
      Terminal/Elf Code
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../kringle-kiosk/" class="md-nav__link">
      Terminal/Kringle Kiosk
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../scapy-prepper/" class="md-nav__link">
      Terminal/Scapy Prepper
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../snowball-fight/" class="md-nav__link">
      Terminal/Snowball Fight
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../sort-o-matic/" class="md-nav__link">
      Terminal/Sort-O-Matic
    </a>
  </li>

    
      
      
      


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Terminal/Speaker Unprep
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Terminal/Speaker Unprep
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shell" class="md-nav__link">
    Shell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#door" class="md-nav__link">
    Door
  </a>
  
    <nav class="md-nav" aria-label="Door">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-01" class="md-nav__link">
    Step 01
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    Flag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lights" class="md-nav__link">
    Lights
  </a>
  
    <nav class="md-nav" aria-label="Lights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-01_1" class="md-nav__link">
    Step 01
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-02" class="md-nav__link">
    Step 02
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-03" class="md-nav__link">
    Step 03
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-04" class="md-nav__link">
    Step 04
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag_1" class="md-nav__link">
    Flag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vending-machines" class="md-nav__link">
    Vending Machines
  </a>
  
    <nav class="md-nav" aria-label="Vending Machines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-01_2" class="md-nav__link">
    Step 01
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-02_1" class="md-nav__link">
    Step 02
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-03_1" class="md-nav__link">
    Step 03
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-04_1" class="md-nav__link">
    Step 04
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-05" class="md-nav__link">
    Step 05
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-06" class="md-nav__link">
    Step 06
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-07" class="md-nav__link">
    Step 07
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-08" class="md-nav__link">
    Step 08
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag_2" class="md-nav__link">
    Flag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../unescape-tmux/" class="md-nav__link">
      Terminal/Unescape Tmux
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shell" class="md-nav__link">
    Shell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#door" class="md-nav__link">
    Door
  </a>
  
    <nav class="md-nav" aria-label="Door">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-01" class="md-nav__link">
    Step 01
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    Flag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lights" class="md-nav__link">
    Lights
  </a>
  
    <nav class="md-nav" aria-label="Lights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-01_1" class="md-nav__link">
    Step 01
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-02" class="md-nav__link">
    Step 02
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-03" class="md-nav__link">
    Step 03
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-04" class="md-nav__link">
    Step 04
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag_1" class="md-nav__link">
    Flag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vending-machines" class="md-nav__link">
    Vending Machines
  </a>
  
    <nav class="md-nav" aria-label="Vending Machines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-01_2" class="md-nav__link">
    Step 01
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-02_1" class="md-nav__link">
    Step 02
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-03_1" class="md-nav__link">
    Step 03
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-04_1" class="md-nav__link">
    Step 04
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-05" class="md-nav__link">
    Step 05
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-06" class="md-nav__link">
    Step 06
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-07" class="md-nav__link">
    Step 07
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-08" class="md-nav__link">
    Step 08
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag_2" class="md-nav__link">
    Flag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="speaker-unprep">Speaker UNPrep</h1>
<h2 id="shell">Shell</h2>
<pre><code class="language-bash">Help us get into the Speaker Unpreparedness Room!

The door is controlled by ./door, but it needs a password! If you can figure
out the password, it'll open the door right up!

Oh, and if you have extra time, maybe you can turn on the lights with ./lights
activate the vending machines with ./vending-machines? Those are a little
trickier, they have configuration files, but it'd help us a lot!

(You can do one now and come back to do the others later if you want)

We copied edit-able versions of everything into the ./lab/ folder, in case you
want to try EDITING or REMOVING the configuration files to see how the binaries
react.

Note: These don't require low-level reverse engineering, so you can put away IDA
and Ghidra (unless you WANT to use them!)
elf@bfa5a25732b3 ~ $
</code></pre>
<h2 id="solution">Solution</h2>
<p>Let's see what's available to us:</p>
<pre><code class="language-bash">elf@bfa5a25732b3 ~ $ ls -alt
total 852
drwxr-xr-x 1 root root   4096 Dec  3 20:43 .
drwxr-xr-x 1 elf  elf    4096 Dec  3 20:43 .local
drwxr-xr-x 1 elf  elf    4096 Dec  3 20:43 lab
drwxr-xr-x 1 root root   4096 Dec  3 20:41 ..
-rwxr-xr-x 1 root root 231728 Dec  1 19:19 door
-rwxr-xr-x 1 root root 276784 Dec  1 19:19 lights
-rwxr-xr-x 1 root root 321840 Dec  1 19:19 vending-machines
-rw-r--r-- 1 root root    102 Oct  1 17:37 .bashrc
-rw-r--r-- 1 root root     92 Oct  1 17:37 lights.conf
-rw-r--r-- 1 root root     59 Oct  1 17:37 vending-machines.json
-rw-r--r-- 1 elf  elf     220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 elf  elf     807 Apr 18  2019 .profile
elf@bfa5a25732b3 ~ $
</code></pre>
<h3 id="door">Door</h3>
<pre><code class="language-bash">elf@bfa5a25732b3 ~ $ file door
door: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpre
ter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=4973fb994a1038936fd611
1fa1e01d95f052a1dd, stripped
elf@bfa5a25732b3 ~ $ ./door
You look at the screen. It wants a password. You roll your eyes - the
password is probably stored right in the binary. There's gotta be a
tool for this...

What do you enter? &gt;
</code></pre>
<h4 id="step-01">Step 01</h4>
<p>Since the password is stored in the binary, we can just search the strings 
in the binary</p>
<pre><code class="language-bash">elf@bfa5a25732b3 ~ $ strings door | grep -i pass
/home/elf/doorYou look at the screen. It wants a password. You roll your eyes - the
password is probably stored right in the binary. There's gotta be a
Be sure to finish the challenge in prod: And don't forget, the password is &quot;Op3nTheD00r&quot;
Beep boop invalid password
elf@bfa5a25732b3 ~ $
</code></pre>
<h4 id="flag">Flag</h4>
<p><code>Op3nTheD00r</code></p>
<h3 id="lights">Lights</h3>
<pre><code class="language-bash">elf@bdd3e4aedbaf ~ $ file lights
lights: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interp
reter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=5bd84970c7dc4ca56105
234dda82c961a3677143, stripped
elf@bdd3e4aedbaf ~ $ ./lights 
The speaker unpreparedness room sure is dark, you're thinking (assuming
you've opened the door; otherwise, you wonder how dark it actually is)

You wonder how to turn the lights on? If only you had some kind of hin---

&gt;&gt;&gt; CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lights.conf

---t to help figure out the password... I guess you'll just have to make do!

The terminal just blinks: Welcome back, elf-technician

What do you enter? &gt; 
</code></pre>
<h4 id="step-01_1">Step 01</h4>
<p>We can check the <code>lights.conf</code> file for a password</p>
<pre><code class="language-bash">elf@bdd3e4aedbaf ~ $ cat lights.conf
password: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
name: elf-technician
</code></pre>
<h4 id="step-02">Step 02</h4>
<p>Then try to pass in the given password value to the interactive prompt</p>
<pre><code class="language-bash">elf@bdd3e4aedbaf ~ $ ./lights 
The speaker unpreparedness room sure is dark, you're thinking (assuming
you've opened the door; otherwise, you wonder how dark it actually is)

You wonder how to turn the lights on? If only you had some kind of hin---

&gt;&gt;&gt; CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lights.conf

---t to help figure out the password... I guess you'll just have to make do!

The terminal just blinks: Welcome back, elf-technician

What do you enter? &gt; E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
Checking......
Beep boop invalid password
elf@bdd3e4aedbaf ~ $ 
</code></pre>
<h4 id="step-03">Step 03</h4>
<p>Looks like the password is encrypted, but the username is decrypted due to
the message, "CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED." So let's
switch the username and password keys in the <code>lights.conf</code> file to see if the
program can decrypt the password value for us.</p>
<pre><code class="language-bash">elf@4f561142e32b ~/lab $ cat lights.conf 
password: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
name: elf-technician
elf@4f561142e32b ~/lab $ vim lights.conf
elf@4f561142e32b ~/lab $ cat lights.conf
name: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
password: elf-technician
elf@4f561142e32b ~/lab $ ./lights 
The speaker unpreparedness room sure is dark, you're thinking (assuming
you've opened the door; otherwise, you wonder how dark it actually is)

You wonder how to turn the lights on? If only you had some kind of hin---

&gt;&gt;&gt; CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lab/lights.conf

---t to help figure out the password... I guess you'll just have to make do!

The terminal just blinks: Welcome back, Computer-TurnLightsOn

What do you enter? &gt; Computer-TurnLightsOn
Checking......
Beep boop invalid password
elf@4f561142e32b ~/lab $ vim lights.conf
elf@4f561142e32b ~/lab $ cat lights.conf
password: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
name: elf-technician
elf@4f561142e32b ~/lab $ ./lights 
The speaker unpreparedness room sure is dark, you're thinking (assuming
you've opened the door; otherwise, you wonder how dark it actually is)

You wonder how to turn the lights on? If only you had some kind of hin---

&gt;&gt;&gt; CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lab/lights.conf

---t to help figure out the password... I guess you'll just have to make do!

The terminal just blinks: Welcome back, elf-technician

What do you enter? &gt; Computer-TurnLightsOn
Checking......
That would have turned on the lights!

If you've figured out the real password, be sure you run /home/elf/lights
elf@4f561142e32b ~/lab $ 
</code></pre>
<h4 id="step-04">Step 04</h4>
<p>Let's try it on prod</p>
<pre><code class="language-bash">elf@4f561142e32b ~ $ ./lights
The speaker unpreparedness room sure is dark, you're thinking (assuming
you've opened the door; otherwise, you wonder how dark it actually is)

You wonder how to turn the lights on? If only you had some kind of hin---

&gt;&gt;&gt; CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lights.conf

---t to help figure out the password... I guess you'll just have to make do!

The terminal just blinks: Welcome back, elf-technician

What do you enter? &gt; Computer-TurnLightsOn
Checking......

Lights on!
elf@4f561142e32b ~ $ 
</code></pre>
<h4 id="flag_1">Flag</h4>
<p><code>Computer-TurnLightsOn</code></p>
<h3 id="vending-machines">Vending Machines</h3>
<pre><code class="language-bash">elf@35af65fe84ed ~/lab $ file vending-machines
vending-machines: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically link
ed, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=23634d9cce
f73f0676a5247d302084267fa92f79, stripped
elf@35af65fe84ed ~/lab $ ./vending-machines 
The elves are hungry!

If the door's still closed or the lights are still off, you know because
you can hear them complaining about the turned-off vending machines!
You can probably make some friends if you can get them back on...

Loading configuration from: /home/elf/lab/vending-machines.json

I wonder what would happen if it couldn't find its config file? Maybe that's
something you could figure out in the lab...

Welcome, elf-maintenance! It looks like you want to turn the vending machines back on?
Please enter the vending-machine-back-on code &gt; test
Checking......
Beep boop invalid password
elf@35af65fe84ed ~/lab $ 
</code></pre>
<h4 id="step-01_2">Step 01</h4>
<p>Let's start removing the config file, as recommended</p>
<pre><code class="language-bash">elf@35af65fe84ed ~/lab $ cat vending-machines.json
{
  &quot;name&quot;: &quot;elf-maintenance&quot;,
  &quot;password&quot;: &quot;LVEdQPpBwr&quot;
}elf@35af65fe84ed ~/lab $ rm vending-machines.json
elf@35af65fe84ed ~/lab $ ./vending-machines
The elves are hungry!

If the door's still closed or the lights are still off, you know because
you can hear them complaining about the turned-off vending machines!
You can probably make some friends if you can get them back on...

Loading configuration from: /home/elf/lab/vending-machines.json

I wonder what would happen if it couldn't find its config file? Maybe that's
something you could figure out in the lab...

ALERT! ALERT! Configuration file is missing! New Configuration File Creator Activated!

Please enter the name &gt; test
Please enter the password &gt; foobar

Welcome, test! It looks like you want to turn the vending machines back on?
Please enter the vending-machine-back-on code &gt; temp-code
Checking......
Beep boop invalid password
elf@35af65fe84ed ~/lab $ ls -lt
total 824
-rw-r--r-- 1 elf elf     44 Jan  4 02:54 vending-machines.json
-rwxr-xr-x 1 elf elf 231728 Dec  3 20:43 door
-rwxr-xr-x 1 elf elf 276784 Dec  3 20:43 lights
-rw-r--r-- 1 elf elf     92 Dec  3 20:43 lights.conf
-rwxr-xr-x 1 elf elf 321840 Dec  3 20:43 vending-machines
elf@35af65fe84ed ~/lab $ cat vending-machines.json
{
  &quot;name&quot;: &quot;test&quot;,
  &quot;password&quot;: &quot;8jfBam&quot;
}elf@35af65fe84ed ~/lab $
</code></pre>
<h4 id="step-02_1">Step 02</h4>
<p>It looks as though removing the .json makes the vending-machine executable
create a new file with the given name and password. Since we're not able to make
any modifications to the prod .json, we can use this new-file-creation feature
to find determine what encryption algorithm encrypts the password.</p>
<pre><code>Let encryption function E_k: P -&gt; C
where P = plaintext space, C = ciphertext space, k = key
=================================
p \in P         | c \in C               
---------------------------------
A               | X
AA              | Xi
AB              | Xq
A1              | Xr
AAA             | XiG
AAAA            | XiGR
AAAAA           | XiGRe
AAAAAA          | XiGReh
BAAAAA          | DiGReh
AAAAAAA         | XiGRehm
AAAAAAAAAAAAAAA | XiGRehmwXiGRehm
</code></pre>
<p>Since each additional plaintext character yields a corresponding additional 
ciphertext character,  we know that the cipher operates on 1-byte blocks,
suggesting a stream cipher like RC4 or Salsa20. Additionally, since changing the
first plaintext character only changes the first ciphertext byte, we can
determine that the algorithm is using electronic codebook (ECB) mode encryption.</p>
<p>Therefore, the plaintext of <code>LVEdQPpBwr</code> is 10 characters long and is easily
bruteforceable as we can test each character sequentially.</p>
<h4 id="step-03_1">Step 03</h4>
<p>Before bruteforcing, let's see if we can generate a wordlist of 10-character
long strings associated with <code>elf-maintenance</code>.</p>
<pre><code># Elf names
Shortstack
shortstack
Bonbowford
bonbowford
Sappington
sappington
Ninecandle
ninecandle

# Associated terms
Kringlecon
kringlecon
</code></pre>
<p>and perform a dictionary attack with the following quick script</p>
<pre><code class="language-bash">elf@da7e515c9976 ~/lab $ touch dict-attack.sh
elf@da7e515c9976 ~/lab $ vim dict-attack.sh
elf@da7e515c9976 ~/lab $ chmod u+x dict-attack.sh
elf@da7e515c9976 ~/lab $ cat dict-attack.sh
#!/bin/bash
WORDS=$(cat wordlist.txt)
for WORD in $WORDS
do
        echo &quot;performing attack with payload: $WORD&quot;
        touch input.txt
        echo &quot;username&quot; &gt; input.txt
        echo $WORD &gt;&gt; input.txt
        echo &quot;temp-code&quot; &gt;&gt; input.txt
        rm vending-machines.json
        cat input.txt | ./vending-machines &gt; /dev/null
        if [ ! -f ./outputs.txt ]; then
                touch outputs.txt
        fi
        echo &quot;$WORD:$(cat vending-machines.json)&quot; &gt;&gt; outputs.txt
done
elf@da7e515c9976 ~/lab $
</code></pre>
<pre><code class="language-bash">elf@da7e515c9976 ~/lab $ ./dict-attack.sh
performing attack with payload: Shortstack
performing attack with payload: shortstack
performing attack with payload: Bonbowford
performing attack with payload: bonbowford
performing attack with payload: Sappington
performing attack with payload: sappington
performing attack with payload: Ninecandle
performing attack with payload: ninecandle
performing attack with payload: Kringlecon
performing attack with payload: kringlecon
elf@da7e515c9976 ~/lab $ cat outputs.txt
Shortstack:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;4nfydSTge6&quot;
}
shortstack:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;AnfydSTge6&quot;
}
Bonbowford:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;DjEBhK5c5R&quot;
}
bonbowford:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;GjEBhK5c5R&quot;
}
Sappington:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;4VM54XfNRh&quot;
}
sappington:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;AVM54XfNRh&quot;
}
Ninecandle:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;Z0EQ6cDbfc&quot;
}
ninecandle:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;b0EQ6cDbfc&quot;
}
Kringlecon:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;FNs6PsuRRh&quot;
}
kringlecon:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;oNs6PsuRRh&quot;
}
elf@da7e515c9976 ~/lab $
</code></pre>
<h4 id="step-04_1">Step 04</h4>
<p>So the first dictionary attack didn't give us anything except the following
characters in the plaintext password: <code>_ a n _ _ _ _ _ _ _</code>. Since the first
character is neither <code>S</code> nor <code>s</code>, the first few characters are not <code>Santa</code>, but
can be <code>C</code>/<code>candycanes</code>. Will just quickly check that out to see if it works.</p>
<pre><code>Candycanes:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;LVEdQEpBw5&quot;
}
candycanes:{
  &quot;name&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;eVEdQEpBw5&quot;
}
</code></pre>
<h4 id="step-05">Step 05</h4>
<p>The <code>Candycanes</code> payload is pretty close to the ciphertext we're trying to
crack: <code>LVEdQPpBwr</code>. Therefore, we know that the plaintext is: <code>C a n d y _ a n
e _</code>. We can then bruteforce the missing blanks to see what the plaintext is.</p>
<p>We start with bruteforcing the first character we don't know with the following
script, where <code>charlist.txt</code> is a wordlist containing alphabet chars:</p>
<pre><code class="language-bash">elf@5b32c1cf8624 ~/lab $ vim bruteforce.sh
elf@5b32c1cf8624 ~/lab $ cat bruteforce.sh
#!/bin/bash
CHARS=$(cat charlist.txt)
for CHAR in $CHARS
do
        echo &quot;performing attack with payload: $CHAR&quot;
        touch input.txt
        echo &quot;username&quot; &gt; input.txt
        echo &quot;Candy${CHAR}ane&quot; &gt;&gt; input.txt
        echo &quot;temp-code&quot; &gt;&gt; input.txt
        rm vending-machines.json
        cat input.txt | ./vending-machines &gt; /dev/null
        OUTPUT=$(cat vending-machines.json | python -c \
                'import json,sys;obj=json.load(sys.stdin);print obj[&quot;password&quot;]')
        if [[ &quot;$OUTPUT&quot; == &quot;LVEdQPpBw&quot; ]]; then
                echo &quot;Found: Candy${CHAR}ane -- $OUTPUT&quot;
                break
        fi
done
elf@5b32c1cf8624 ~/lab $
</code></pre>
<pre><code class="language-bash">elf@5b32c1cf8624 ~/lab $ ./bruteforce.sh 
performing attack with payload: t
performing attack with payload: y
performing attack with payload: u
performing attack with payload: i
performing attack with payload: o
performing attack with payload: p
performing attack with payload: a
performing attack with payload: s
performing attack with payload: d
performing attack with payload: f
performing attack with payload: g
performing attack with payload: h
performing attack with payload: j
performing attack with payload: k
performing attack with payload: l
performing attack with payload: z
performing attack with payload: x
performing attack with payload: c
performing attack with payload: v
performing attack with payload: b
performing attack with payload: n
performing attack with payload: m
performing attack with payload: Q
performing attack with payload: W
performing attack with payload: E
performing attack with payload: R
performing attack with payload: T
performing attack with payload: Y
performing attack with payload: U
performing attack with payload: I
performing attack with payload: O
performing attack with payload: P
performing attack with payload: A
performing attack with payload: S
performing attack with payload: D
performing attack with payload: F
performing attack with payload: G
performing attack with payload: H
performing attack with payload: J
performing attack with payload: K
performing attack with payload: L
performing attack with payload: Z
performing attack with payload: X
performing attack with payload: C
Found: CandyCane -- LVEdQPpBw
elf@5b32c1cf8624 ~/lab $ 
</code></pre>
<h4 id="step-06">Step 06</h4>
<p>And we modify the <code>bruteforce.sh</code> script with the found <code>C</code> to find the final
unknown character</p>
<pre><code class="language-bash">elf@5b32c1cf8624 ~/lab $ vim bruteforce.sh
elf@5b32c1cf8624 ~/lab $ cat bruteforce.sh
#!/bin/bash
CHARS=$(cat charlist.txt)
for CHAR in $CHARS
do
        echo &quot;performing attack with payload: $CHAR&quot;
        touch input.txt
        echo &quot;username&quot; &gt; input.txt
        echo &quot;CandyCane${CHAR}&quot; &gt;&gt; input.txt
        echo &quot;temp-code&quot; &gt;&gt; input.txt
        rm vending-machines.json
        cat input.txt | ./vending-machines &gt; /dev/null
        OUTPUT=$(cat vending-machines.json | python -c \
                'import json,sys;obj=json.load(sys.stdin);print obj[&quot;password&quot;]')
        if [[ &quot;$OUTPUT&quot; == &quot;LVEdQPpBwr&quot; ]]; then
                echo &quot;Found: CandyCane${CHAR} -- $OUTPUT&quot;
                break
        fi
done
elf@5b32c1cf8624 ~/lab $
</code></pre>
<h4 id="step-07">Step 07</h4>
<p>Nothing was found, so let's bruteforce the final character with numbers and
symbols (<code>numsymlist.txt</code> is a wordlist of numbers and symbols):</p>
<pre><code class="language-bash">elf@5b32c1cf8624 ~/lab $ vim bruteforce.sh 
elf@5b32c1cf8624 ~/lab $ cat bruteforce.sh 
#!/bin/bash
CHARS=$(cat numsymlist.txt)
for CHAR in $CHARS
do
        echo &quot;performing attack with payload: $CHAR&quot;
        touch input.txt
        echo &quot;username&quot; &gt; input.txt
        echo &quot;CandyCane${CHAR}&quot; &gt;&gt; input.txt
        echo &quot;temp-code&quot; &gt;&gt; input.txt
        rm vending-machines.json
        cat input.txt | ./vending-machines &gt; /dev/null
        OUTPUT=$(cat vending-machines.json | python -c \
                'import json,sys;obj=json.load(sys.stdin);print obj[&quot;password&quot;]')
        if [[ &quot;$OUTPUT&quot; == &quot;LVEdQPpBwr&quot; ]]; then
                echo &quot;Found: CandyCane${CHAR} -- $OUTPUT&quot;
                break
        fi
done
elf@5b32c1cf8624 ~/lab $ 
</code></pre>
<pre><code class="language-bash">elf@5b32c1cf8624 ~/lab $ ./bruteforce.sh
performing attack with payload: 1
Found: CandyCane1 -- LVEdQPpBwr
elf@5b32c1cf8624 ~/lab $
</code></pre>
<h4 id="step-08">Step 08</h4>
<p>Et voil√†! Let's try out <code>CandyCane1</code></p>
<pre><code class="language-bash">elf@5b32c1cf8624 ~ $ ./vending-machines
The elves are hungry!

If the door's still closed or the lights are still off, you know because
you can hear them complaining about the turned-off vending machines!
You can probably make some friends if you can get them back on...

Loading configuration from: /home/elf/vending-machines.json

I wonder what would happen if it couldn't find its config file? Maybe that's
something you could figure out in the lab...

Welcome, elf-maintenance! It looks like you want to turn the vending machines back on?
Please enter the vending-machine-back-on code &gt; CandyCane1
Checking......

Vending machines enabled!!
elf@5b32c1cf8624 ~ $
</code></pre>
<h4 id="flag_2">Flag</h4>
<p><code>CandyCane1</code></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../sort-o-matic/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Terminal/Sort-O-Matic
              </div>
            </div>
          </a>
        
        
          <a href="../unescape-tmux/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Terminal/Unescape Tmux
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>